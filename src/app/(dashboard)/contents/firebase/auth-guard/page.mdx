
> ğŸ“Œ **ã“ã®è¨˜äº‹ã§å­¦ã¶ã“ã¨**
>
> - èªè¨¼ãŒå¿…è¦ãªãƒšãƒ¼ã‚¸ã®ä¿è­·
> - PrivateRoute ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
> - ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå‡¦ç†

## èªè¨¼ã‚¬ãƒ¼ãƒ‰ã¨ã¯ï¼Ÿ

ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€ãƒ­ã‚°ã‚¤ãƒ³å¿…é ˆã®ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸå ´åˆã€**ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ**ã™ã‚‹ä»•çµ„ã¿ã§ã™ã€‚

> ğŸ’¡ **Protected Routes ã¨ã¯ï¼Ÿ**
>
> ã€Œä¿è­·ã•ã‚ŒãŸãƒ«ãƒ¼ãƒˆã€ã¨ã„ã†æ„å‘³ã§ã€èªè¨¼ãŒå¿…è¦ãªãƒšãƒ¼ã‚¸ã®ã“ã¨ã§ã™ã€‚
> è¦‹ãˆãªã„ã‚¬ãƒ¼ãƒ‰ãƒãƒ³ãŒã€Œãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„äººã¯å…¥ã‚Œã¾ã›ã‚“ã€ã¨å®ˆã£ã¦ã„ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚

## PrivateRoute ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

**src/components/PrivateRoute.jsx**

```jsx
import { Navigate } from "react-router-dom";
import { useAuth } from "../contexts/AuthContext";

function PrivateRoute({ children }) {
  const { currentUser, loading } = useAuth();

  if (loading) {
    return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
  }

  if (!currentUser) {
    return <Navigate to="/login" replace />;
  }

  return children;
}

export default PrivateRoute;
```

## ä½¿ã„æ–¹

**src/App.jsx**

```jsx
import { BrowserRouter, Routes, Route } from "react-router-dom";
import PrivateRoute from "./components/PrivateRoute";
import Home from "./pages/Home";
import Dashboard from "./pages/Dashboard";
import Login from "./pages/Login";
import SignUp from "./pages/SignUp";

function App() {
  return (
    <BrowserRouter>
      <Routes>
        {/* å…¬é–‹ãƒ«ãƒ¼ãƒˆ */}
        <Route path="/" element={<Home />} />
        <Route path="/login" element={<Login />} />
        <Route path="/signup" element={<SignUp />} />

        {/* èªè¨¼ãŒå¿…è¦ãªãƒ«ãƒ¼ãƒˆ */}
        <Route
          path="/dashboard"
          element={
            <PrivateRoute>
              <Dashboard />
            </PrivateRoute>
          }
        />
      </Routes>
    </BrowserRouter>
  );
}
```

## ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸå ´åˆã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã¾ã™ã€‚

**src/pages/Login.jsx**

```jsx
import { useState } from "react";
import { useNavigate, Navigate } from "react-router-dom";
import { signInWithEmailAndPassword } from "firebase/auth";
import { auth } from "../lib/firebase";
import { useAuth } from "../contexts/AuthContext";

function Login() {
  const { currentUser } = useAuth();
  const navigate = useNavigate();
  const [email, setEmail] = useState("");
  const [password, setPassword] = useState("");
  const [error, setError] = useState("");

  // æ—¢ã«ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ãªã‚‰ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
  if (currentUser) {
    return <Navigate to="/dashboard" replace />;
  }

  const handleSubmit = async (e) => {
    e.preventDefault();
    try {
      await signInWithEmailAndPassword(auth, email, password);
      navigate("/dashboard");
    } catch (err) {
      setError("ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ");
    }
  };

  // ãƒ•ã‚©ãƒ¼ãƒ ...
}
```

## ã‚ˆã‚Šé«˜åº¦ãªèªè¨¼ã‚¬ãƒ¼ãƒ‰

å…ƒã®ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹æ©Ÿèƒ½ã‚’è¿½åŠ ï¼š

```jsx
import { Navigate, useLocation } from "react-router-dom";
import { useAuth } from "../contexts/AuthContext";

function PrivateRoute({ children }) {
  const { currentUser, loading } = useAuth();
  const location = useLocation();

  if (loading) {
    return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
  }

  if (!currentUser) {
    // å…ƒã®ãƒ‘ã‚¹ã‚’ state ã«ä¿å­˜
    return <Navigate to="/login" state={{ from: location }} replace />;
  }

  return children;
}
```

ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸå¾Œã«å…ƒã®ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹ï¼š

```jsx
function Login() {
  const navigate = useNavigate();
  const location = useLocation();
  const from = location.state?.from?.pathname || "/dashboard";

  const handleSubmit = async (e) => {
    e.preventDefault();
    try {
      await signInWithEmailAndPassword(auth, email, password);
      navigate(from, { replace: true }); // å…ƒã®ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
    } catch (err) {
      setError("ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ");
    }
  };
  // ...
}
```

## ã¾ã¨ã‚

- **PrivateRoute** ã§ãƒ­ã‚°ã‚¤ãƒ³å¿…é ˆãƒšãƒ¼ã‚¸ã‚’ä¿è­·
- æœªãƒ­ã‚°ã‚¤ãƒ³ãªã‚‰**ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ**
- ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ãªã‚‰ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã‹ã‚‰**ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ**
- `location.state` ã§å…ƒã®ãƒšãƒ¼ã‚¸æƒ…å ±ã‚’ä¿æŒ

## ğŸ¯ ã‚„ã£ã¦ã¿ã‚ˆã†

> ğŸ’¡ **ãƒŸãƒ‹æ¼”ç¿’**
>
> 1. `PrivateRoute` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„
> 2. `/dashboard` ãƒ«ãƒ¼ãƒˆã‚’ `PrivateRoute` ã§ä¿è­·ã—ã¦ã¿ã¾ã—ã‚‡ã†
> 3. ãƒ­ã‚°ã‚¢ã‚¦ãƒˆçŠ¶æ…‹ã§ `/dashboard` ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
>
> **ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**: ãƒ­ã‚°ã‚¤ãƒ³å¾Œã¯ `/dashboard` ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã‹ï¼Ÿ

---

## ğŸ”— æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

èªè¨¼ã‚¬ãƒ¼ãƒ‰ãŒã§ããŸã‚‰ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®ç®¡ç† ã«é€²ã¿ã¾ã—ã‚‡ã†ï¼
