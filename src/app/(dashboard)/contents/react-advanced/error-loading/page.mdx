# ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹

> ğŸ“Œ **ã“ã®è¨˜äº‹ã§å­¦ã¶ã“ã¨**
>
> - ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã®ç®¡ç†
> - ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã®ç®¡ç†
> - ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥
> - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å„ªã—ã„ã‚¨ãƒ©ãƒ¼è¡¨ç¤º

## 3 ã¤ã®çŠ¶æ…‹ãƒ‘ã‚¿ãƒ¼ãƒ³

éåŒæœŸå‡¦ç†ã§ã¯ã€3 ã¤ã®çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹ã®ãŒä¸€èˆ¬çš„ã§ã™ã€‚

```jsx
const [data, setData] = useState(null);
const [loading, setLoading] = useState(false);
const [error, setError] = useState(null);
```

### ãªãœã“ã® 3 ã¤ï¼Ÿ

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é©åˆ‡ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’è¿”ã™ãŸã‚ã§ã™ï¼š

| çŠ¶æ…‹             | è¡¨ç¤ºå†…å®¹                        |
| ---------------- | ------------------------------- |
| `loading = true` | ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ãƒ”ãƒŠãƒ¼            |
| `error` ãŒã‚ã‚‹   | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ + å†è©¦è¡Œãƒœã‚¿ãƒ³ |
| `data` ãŒã‚ã‚‹    | ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º                      |

> ğŸ’¡ **ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚„ã‚¨ãƒ©ãƒ¼ã‚’ç„¡è¦–ã™ã‚‹ã¨...**
> ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã€Œãƒ•ãƒªãƒ¼ã‚ºã—ãŸï¼Ÿã€ã€Œå£Šã‚ŒãŸï¼Ÿã€ã¨ä¸å®‰ã«ãªã‚Šã¾ã™ã€‚

## åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³

```jsx
function DataFetcher() {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  useEffect(() => {
    const fetchData = async () => {
      try {
        setLoading(true);
        setError(null);
        const response = await fetch("/api/data");
        if (!response.ok) throw new Error("ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ");
        const result = await response.json();
        setData(result);
      } catch (err) {
        setError(err.message);
      } finally {
        setLoading(false);
      }
    };

    fetchData();
  }, []);

  if (loading) return <LoadingSpinner />;
  if (error) return <ErrorMessage message={error} />;
  if (!data) return null;

  return <DataDisplay data={data} />;
}
```

## ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º

### ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¹ãƒ”ãƒŠãƒ¼

```jsx
function LoadingSpinner() {
  return (
    <div className="flex justify-center items-center p-8">
      <div className="animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent" />
    </div>
  );
}
```

### ã‚¹ã‚±ãƒ«ãƒˆãƒ³

```jsx
function TodoSkeleton() {
  return (
    <div className="animate-pulse">
      <div className="h-4 bg-gray-200 rounded w-3/4 mb-2" />
      <div className="h-4 bg-gray-200 rounded w-1/2" />
    </div>
  );
}
```

## ã‚¨ãƒ©ãƒ¼è¡¨ç¤º

### ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

```jsx
function ErrorMessage({ message, onRetry }) {
  return (
    <div className="bg-red-50 border border-red-200 rounded p-4 text-center">
      <p className="text-red-600 mb-2">{message}</p>
      {onRetry && (
        <button
          onClick={onRetry}
          className="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600"
        >
          å†è©¦è¡Œ
        </button>
      )}
    </div>
  );
}
```

## ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥

æˆåŠŸãƒ»å¤±æ•—ã‚’ãƒˆãƒ¼ã‚¹ãƒˆã§è¡¨ç¤ºã—ã¾ã™ã€‚

### ã‚·ãƒ³ãƒ—ãƒ«ãªãƒˆãƒ¼ã‚¹ãƒˆ

```jsx
import { useState, useEffect } from "react";

function useToast() {
  const [toast, setToast] = useState(null);

  const showToast = (message, type = "success") => {
    setToast({ message, type });
  };

  const hideToast = () => {
    setToast(null);
  };

  // è‡ªå‹•ã§æ¶ˆãˆã‚‹
  useEffect(() => {
    if (toast) {
      const timer = setTimeout(hideToast, 3000);
      return () => clearTimeout(timer);
    }
  }, [toast]);

  return { toast, showToast, hideToast };
}

function Toast({ message, type }) {
  const bgColor = type === "success" ? "bg-green-500" : "bg-red-500";

  return (
    <div
      className={`fixed bottom-4 right-4 ${bgColor} text-white px-6 py-3 rounded shadow-lg`}
    >
      {message}
    </div>
  );
}
```

### ä½¿ç”¨ä¾‹

```jsx
function App() {
  const { toast, showToast } = useToast();

  const handleSave = async () => {
    try {
      await saveData();
      showToast("ä¿å­˜ã—ã¾ã—ãŸï¼", "success");
    } catch (err) {
      showToast("ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ", "error");
    }
  };

  return (
    <div>
      <button onClick={handleSave}>ä¿å­˜</button>
      {toast && <Toast message={toast.message} type={toast.type} />}
    </div>
  );
}
```

## æ“ä½œä¸­ã®çŠ¶æ…‹

ãƒœã‚¿ãƒ³ãªã©ã€æ“ä½œä¸­ã¯ç„¡åŠ¹åŒ–ã—ã¾ã™ã€‚

```jsx
function SaveButton({ onSave }) {
  const [saving, setSaving] = useState(false);

  const handleClick = async () => {
    setSaving(true);
    try {
      await onSave();
    } finally {
      setSaving(false);
    }
  };

  return (
    <button onClick={handleClick} disabled={saving}>
      {saving ? "ä¿å­˜ä¸­..." : "ä¿å­˜"}
    </button>
  );
}
```

## ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°

å‰Šé™¤ãªã©ã®ç ´å£Šçš„æ“ä½œã«ã¯ç¢ºèªã‚’å…¥ã‚Œã¾ã™ã€‚

```jsx
function DeleteButton({ onDelete, itemName }) {
  const handleDelete = () => {
    if (window.confirm(`ã€Œ${itemName}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) {
      onDelete();
    }
  };

  return (
    <button onClick={handleDelete} className="text-red-500">
      å‰Šé™¤
    </button>
  );
}
```

## ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã«ã¾ã¨ã‚ã‚‹

```jsx
function useAsync(asyncFunction) {
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);
  const [data, setData] = useState(null);

  const execute = async (...args) => {
    try {
      setLoading(true);
      setError(null);
      const result = await asyncFunction(...args);
      setData(result);
      return result;
    } catch (err) {
      setError(err.message);
      throw err;
    } finally {
      setLoading(false);
    }
  };

  return { loading, error, data, execute };
}

// ä½¿ç”¨ä¾‹
function App() {
  const { loading, error, data, execute } = useAsync(fetchTodos);

  useEffect(() => {
    execute();
  }, []);

  // ...
}
```

## ã¾ã¨ã‚

- **3 ã¤ã®çŠ¶æ…‹**ï¼šdata, loading, error
- **ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°**ï¼šã‚¹ãƒ”ãƒŠãƒ¼ã‚„ã‚¹ã‚±ãƒ«ãƒˆãƒ³
- **ã‚¨ãƒ©ãƒ¼**ï¼šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨å†è©¦è¡Œãƒœã‚¿ãƒ³
- **ãƒˆãƒ¼ã‚¹ãƒˆ**ï¼šæ“ä½œã®çµæœã‚’é€šçŸ¥
- **ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°**ï¼šç ´å£Šçš„æ“ä½œã®å‰ã«ç¢ºèª
- **ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯**ã§ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å†åˆ©ç”¨

## ç·´ç¿’å•é¡Œ

ä»¥ä¸‹ã®ä»•æ§˜ã§ API ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

1. `https://jsonplaceholder.typicode.com/users` ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã‚’å–å¾—
2. ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­ã¯ã‚¹ãƒ”ãƒŠãƒ¼è¡¨ç¤º
3. ã‚¨ãƒ©ãƒ¼æ™‚ã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ + å†è©¦è¡Œãƒœã‚¿ãƒ³

### å›ç­”ä¾‹

```jsx
import { useState, useEffect } from "react";

function UserList() {
  const [users, setUsers] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  const fetchUsers = async () => {
    try {
      setLoading(true);
      setError(null);
      const res = await fetch("https://jsonplaceholder.typicode.com/users");
      if (!res.ok) throw new Error("å–å¾—å¤±æ•—");
      const data = await res.json();
      setUsers(data);
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    fetchUsers();
  }, []);

  if (loading) return <p>èª­ã¿è¾¼ã¿ä¸­...</p>;
  if (error)
    return (
      <div>
        <p>{error}</p>
        <button onClick={fetchUsers}>å†è©¦è¡Œ</button>
      </div>
    );

  return (
    <ul>
      {users.map((user) => (
        <li key={user.id}>{user.name}</li>
      ))}
    </ul>
  );
}
```

---

## ğŸ”— æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒã‚ã‹ã£ãŸã‚‰ã€[ã‚¿ã‚¹ã‚¯ç®¡ç†ã‚¢ãƒ—ãƒªï¼ˆæœ¬æ ¼ç‰ˆï¼‰ã‚’ä½œã‚ã†](./04-14_ã‚¿ã‚¹ã‚¯ç®¡ç†ã‚¢ãƒ—ãƒªæœ¬æ ¼ç‰ˆ.md) ã«é€²ã¿ã¾ã—ã‚‡ã†ï¼
